<html>
	<head>
		<title>C.O.D. Parking Map</title>
		<link href="../images/Google Maps Icon.ico" rel="shortcut icon">
		<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
		<script type="text/javascript" src="../js/mapUtilities.js"></script>
		<script type="text/javascript" src="../js/parkingLocations.js"></script>
		<script type="text/javascript">
			var infowindow;
			(function () {
				google.maps.Map.prototype.markers = new Array();
				
				google.maps.Map.prototype.addMarker = function(marker) {
					this.markers[this.markers.length] = marker;
				};
				
				google.maps.Map.prototype.getMarkers = function() {
					return this.markers
				};
				
				google.maps.Map.prototype.clearMarkers = function() {
					if(infowindow) {
						infowindow.close();
					}
				
					for(var i=0; i<this.markers.length; i++){
						this.markers[i].set_map(null);
					}
				};
			})();

			function initialize() {
				var myOptions = {
					zoom: 15,
					center: new google.maps.LatLng(38.90394, -77.01),
					mapTypeId: google.maps.MapTypeId.ROADMAP
					//mapTypeId: google.maps.MapTypeId.SATELLITE
				};
				
				map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

				var locations = getLocations();
				for (var i = 0; i < locations.length; i++) {
					map.addMarker(createMarker(locations[i]));
				 }
			}
			
			

			function createMarker(location) {
				var latLng = new google.maps.LatLng(location.latitude, location.longitude);
				var content = getContentOfMarker(location);
				var color = getColorOfMarker(location);
				var pin = new google.maps.MarkerImage("http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|" + color,
					new google.maps.Size(21, 34),
					new google.maps.Point(0,0),
					new google.maps.Point(10, 34));

				var marker = new google.maps.Marker(
					{
						position: latLng, 
						map: map,
						icon: pin
					}
				);
				google.maps.event.addListener(marker, "click", function() {
					if (infowindow) 
						infowindow.close();
					infowindow = new google.maps.InfoWindow({content: content});
					infowindow.open(map, marker);
				});
				return marker;
			}
		</script>
	</head>
	<body onload="initialize()" style = "min-height: 350px; height: 98%; padding-left: 5px; padding-right: 5px;">
		<div id = 'mapHolder' style = 'min-width: 300px; width: 100%; min-height: 335px; height: 100%'>
			<div id = 'header' style = 'margin-left:auto; margin-right:0; width: 80%; text-align: center'><font size = '4'><b>C.O.D. Parking Map</b></font></div>
			<div id = 'legend' style = 'background-color: #E8E88D; clear: both; text-align: center; float: left; min-width: 60px; width: 20%; min-height: 300px; height: calc(100% - 25px)'>
				<font size = '5'><b>Legend:</b></font><br/>
				<table style = 'text-align: left'>
					<tr><td><font size = '4' color = 'black'><b>Pin Color</b></font></td>	<td style = 'text-align: center'><font size = '4' color = 'black'><b>Description</b></font></td></tr>
					<tr><td><font size = '4' color = 'black'><b>BLACK</b></font></td>		<td><font color = 'black'>Home</font></td></tr>
					<tr><td><font size = '4' color = 'red'><b>RED</b></font></td>			<td><font color = 'red'>Cheap Parking (under $6/day)</font></td></tr>
					<tr><td><font size = '4' color = 'yellow'><b>YELLOW</b></font></td>		<td><font color = 'yellow'>Zone Parking (Free Parking for Limited Time for Non-residents, Unlimited Free Parking for Zone Residents)</font></td></tr>
					<tr><td><font size = '4' color = 'orange'><b>ORANGE</b></font></td>		<td><font color = 'orange'>Time-Restricted Parking (Free Parking for Limited Time)</font></td></tr>
					<tr><td><font size = '4' color = 'green'><b>GREEN</b></font></td>		<td><font color = 'green'>Free Parking</font></td></tr>
					<tr><td><font size = '4' color = 'blue'><b>BLUE</b></font></td>			<td><font color = 'blue'>COD</font></td></tr>
				</table>
			</div>
			<div id = "map_canvas" style = "margin-left:auto; margin-right:0; min-width: 240px; width: 80%; min-height: 300px; height: calc(100% - 25px)"></div>
		</div>
		<a href="http://stackoverflow.com/questions/1544739/google-maps-api-v3-how-to-remove-all-markers/1544885#1544885"></a>
	</body>
</html>