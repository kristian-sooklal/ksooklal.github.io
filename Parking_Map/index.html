<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="initial-scale=1.0, user-scalable=no">
		<meta charset="utf-8">
		<title>C.O.D. Parking Map</title>
		<style>
			html, body, #map-canvas {
				height: 100%;
				margin: 0px;
				padding: 0px
			}
		</style>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
		<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&signed_in=true"></script>
		<script src='https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.js'></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
		<script src='../js/appConversion.js'></script>
		<script>
			var map;
			
				
			(function () {
				google.maps.Map.prototype.markers = new Array();

				google.maps.Map.prototype.addMarker = function(marker) {
					this.markers[this.markers.length] = marker;
				};

				google.maps.Map.prototype.getMarkers = function() {
					return this.markers
				};

				google.maps.Map.prototype.clearMarkers = function() {
					if(infowindow) {
					infowindow.close();
					}

					for(var i=0; i<this.markers.length; i++){
						this.markers[i].set_map(null);
					}
				};
			})();
		
		
		
			function ParkingDescription(){
				this.zoneRestriction = 0;
				this.streetCleaning = false;
				this.cost = 0;
				this.garage = false;
			}
		
			function ParkingDescription(zoneRestriction, streetCleaning, cost, garage){
				this.cost = cost;
				this.streetCleaning = streetCleaning;
				this.garage = false;
				this.zoneRestriction = zoneRestriction;
			}
		
			function Location(locationName, locationType, latitude, longitude, locationAddress, zIndex, parkingDescription) {
				this.locationName = locationName;
				this.locationType = locationType;
				this.latitude = latitude;
				this.longitude = longitude;
				this.locationAddress = locationAddress;
				this.zIndex = zIndex;
				this.parkingDescription = parkingDescription;
			}
			
			function Location(locationName, locationType, latitude, longitude, locationAddress){
				this.parkingDescription = null;
				this.zIndex = 1;
				this.latitude = latitude;
				this.locationType = locationType;
				this.locationAddress = locationAddress;
				this.locationName = locationName;
				this.longitude = longitude;
			}

			function initialize() {
				var mapOptions = {
					zoom: 12,
					center: new google.maps.LatLng(38.9007471, -77.00649629999998)
				}
				map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
				
				var coordinates = 	[
										new Location("COD", "Work", 38.9007471, -77.00649629999998, "820 First Street NE Washington DC 20002"),
										new Location("Kristian", "Home", 38.9931229, -77.0234289, "820 First Street NE Washington DC 20002")
									];
				var addresses = 	[
										["COD", "820 First St. NE, Washington DC 20002"]
									];
				setMarkers(map, coordinates);
			}

			var priorityIndex = 1;

			function setMarkers(map, locations) {
				for (var i = 0; i < locations.length; i++) {
					var location = locations[i];
					var myLatLng = new google.maps.LatLng(location.latitude, location.longitude);
					var name = location.locationName;
					var address = location.locationAddress;
					var lat = encodeAddress(address);
					var myText = "<h3>" + name + "</h3><br/>" + lat;
					var myInfoWindow = new google.maps.InfoWindow({
						content: myText
					});

					map.addMarker(createMarker(myText, myLatLng));
					/*
					var marker = new google.maps.Marker({
						position: myLatLng,
						map: map,
						icon: 'http://maps.google.com/mapfiles/ms/icons/red-dot.png',
						title: location.locationName,
						zIndex: location.zIndex,
						infoWindow: myInfoWindow
					});
					marker.setMap(map);*/
					google.maps.event.addListener(marker, 'click', function() {
						myInfoWindow.open(map,marker);
					});
				}
			}
			
			function createMarker(name, latlng) {
				var marker = new google.maps.Marker({position: latlng, map: map});
				google.maps.event.addListener(marker, "click", function() {
					if (infowindow) 
						infowindow.close();
					infowindow = new google.maps.InfoWindow({content: name});
					infowindow.open(map, marker);
				});
				return marker;
			}
			
			google.maps.event.addDomListener(window, 'load', initialize);
		</script>
	</head>
	<body>
			<div style="width: 80%; max-height:90%; text-align: center;" id="map-canvas"></div>
</form> 
	</body>
</html>